

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>BFEE2.gui &mdash; BFEE2  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> BFEE2
          

          
          </a>

          
            
            
              <div class="version">
                2.1.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python_api.html">Python API</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">BFEE2</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>BFEE2.gui</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for BFEE2.gui</h1><div class="highlight"><pre>
<span></span><span class="c1"># the GUI of new BFEE</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>

<span class="c1"># use appdirs to manage persistent configuration</span>
<span class="kn">from</span> <span class="nn">appdirs</span> <span class="kn">import</span> <span class="n">user_config_dir</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span>
<span class="kn">from</span> <span class="nn">PySide2.QtGui</span> <span class="kn">import</span> <span class="n">QFont</span><span class="p">,</span> <span class="n">QIcon</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QAction</span><span class="p">,</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QCheckBox</span><span class="p">,</span> <span class="n">QComboBox</span><span class="p">,</span>
                               <span class="n">QFileDialog</span><span class="p">,</span> <span class="n">QGridLayout</span><span class="p">,</span> <span class="n">QGroupBox</span><span class="p">,</span>
                               <span class="n">QHBoxLayout</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QListWidget</span><span class="p">,</span>
                               <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span>
                               <span class="n">QSplitter</span><span class="p">,</span> <span class="n">QTabWidget</span><span class="p">,</span> <span class="n">QToolBar</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span>
                               <span class="n">QWidget</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">BFEE2.inputGenerator</span> <span class="k">as</span> <span class="nn">inputGenerator</span>
<span class="kn">import</span> <span class="nn">BFEE2.postTreatment</span> <span class="k">as</span> <span class="nn">postTreatment</span>
<span class="kn">import</span> <span class="nn">BFEE2.templates_gromacs.BFEEGromacs</span> <span class="k">as</span> <span class="nn">BFEEGromacs</span>
<span class="kn">from</span> <span class="nn">BFEE2.commonTools</span> <span class="kn">import</span> <span class="n">commonSlots</span><span class="p">,</span> <span class="n">fileParser</span><span class="p">,</span> <span class="n">ploter</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">importlib.resources</span> <span class="k">as</span> <span class="nn">pkg_resources</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="c1"># Try backported to PY&lt;37 `importlib_resources`.</span>
    <span class="kn">import</span> <span class="nn">importlib_resources</span> <span class="k">as</span> <span class="nn">pkg_resources</span>

<span class="kn">import</span> <span class="nn">BFEE2.version</span>
<span class="kn">from</span> <span class="nn">BFEE2</span> <span class="kn">import</span> <span class="n">doc</span>

<span class="n">__PROGRAM_NAME__</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;BFEEstimator v</span><span class="si">{</span><span class="n">BFEE2</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">__VERSION__</span><span class="si">}</span><span class="s1">&#39;</span>

<div class="viewcode-block" id="mainSettings"><a class="viewcode-back" href="../../BFEE2.gui.html#BFEE2.gui.mainSettings">[docs]</a><span class="k">class</span> <span class="nc">mainSettings</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;settings in the menubar</span>
<span class="sd">       set pathes of third-party softwares (VMD, gmx and tleap)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span> <span class="o">=</span> <span class="n">user_config_dir</span><span class="p">(</span><span class="s1">&#39;BFEE2&#39;</span><span class="p">,</span> <span class="s1">&#39;chinfo&#39;</span><span class="p">)</span>
        <span class="c1"># test if config directory exists</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">):</span>
            <span class="c1"># create it if not exists</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initUI</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initSingalsSlots</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;Settings&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_readConfig</span><span class="p">()</span>
        <span class="c1">#self.setGeometry(0,0,0,0)</span>
        <span class="c1">#self.show()</span>

    <span class="k">def</span> <span class="nf">_initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;settings GUI</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">thirdPartySoftware</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Third party software:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thirdPartySoftwareLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="c1"># settings grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settingsGridLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="c1"># vmd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmdLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;VMD:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmdLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmdButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settingsGridLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vmdLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settingsGridLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vmdLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settingsGridLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vmdButton</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># gmx</span>
        <span class="c1">#self.gromacsLayout = QHBoxLayout()</span>
        <span class="c1">#self.gromacsLabel = QLabel(&#39;Gromacs:&#39;)</span>
        <span class="c1">#self.gromacsLineEdit = QLineEdit()</span>
        <span class="c1">#self.gromacsButton = QPushButton(&#39;Browse&#39;)</span>
        <span class="c1">#self.settingsGridLayout.addWidget(self.gromacsLabel, 1, 0)</span>
        <span class="c1">#self.settingsGridLayout.addWidget(self.gromacsLineEdit,1 ,1)</span>
        <span class="c1">#self.settingsGridLayout.addWidget(self.gromacsButton, 1, 2)</span>

        <span class="c1"># tleap</span>
        <span class="c1">#self.tleapLayout = QHBoxLayout()</span>
        <span class="c1">#self.tleapLabel = QLabel(&#39;tleap:&#39;)</span>
        <span class="c1">#self.tleapLineEdit = QLineEdit()</span>
        <span class="c1">#self.tleapButton = QPushButton(&#39;Browse&#39;)</span>
        <span class="c1">#self.settingsGridLayout.addWidget(self.tleapLabel, 2, 0)</span>
        <span class="c1">#self.settingsGridLayout.addWidget(self.tleapLineEdit, 2, 1)</span>
        <span class="c1">#self.settingsGridLayout.addWidget(self.tleapButton, 2, 2)</span>

        <span class="c1"># OK and Cancel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settingsButtonLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settingsOKButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;OK&#39;</span><span class="p">)</span>
        <span class="c1">#self.settingsCancelButton = QPushButton(&#39;Cancel&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settingsButtonLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QSplitter</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settingsButtonLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsOKButton</span><span class="p">)</span>
        <span class="c1">#self.settingsButtonLayout.addWidget(self.settingsCancelButton)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">thirdPartySoftwareLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsGridLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thirdPartySoftwareLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsButtonLayout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">thirdPartySoftware</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thirdPartySoftwareLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thirdPartySoftware</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initSingalsSlots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize singals and slots</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmdButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;exe&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmdLineEdit</span><span class="p">))</span>
        <span class="c1">#self.gromacsButton.clicked.connect(commonSlots.openFileDialog(&#39;exe&#39;, self.gromacsLineEdit))</span>
        <span class="c1">#self.tleapButton.clicked.connect(commonSlots.openFileDialog(&#39;exe&#39;, self.tleapLineEdit))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settingsOKButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_OKSlot</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_readConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;read the config saving paths for third-party softwares</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="si">}</span><span class="s1">/3rdSoft.ini&#39;</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="si">}</span><span class="s1">/3rdSoft.ini&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cFile</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">cFile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vmdLineEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="c1">#line = cFile.readline()</span>
            <span class="c1">#self.gromacsLineEdit.setText(line.strip())</span>
            <span class="c1">#line = cFile.readline()</span>
            <span class="c1">#self.tleapLineEdit.setText(line.strip())</span>

    <span class="k">def</span> <span class="nf">_writeConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;write the config saving paths for third-party softwares</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="si">}</span><span class="s1">/3rdSoft.ini&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cFile</span><span class="p">:</span>
            <span class="n">cFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vmdLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1">#cFile.write(self.gromacsLineEdit.text() + &#39;\n&#39;)</span>
            <span class="c1">#cFile.write(self.tleapLineEdit.text() + &#39;\n&#39;)</span>

    <span class="k">def</span> <span class="nf">_OKSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;the slot corresponding the OK button</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">f</span><span class="p">():</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_writeConfig</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">f</span></div>

<div class="viewcode-block" id="geometricAdvancedSettings"><a class="viewcode-back" href="../../BFEE2.gui.html#BFEE2.gui.geometricAdvancedSettings">[docs]</a><span class="k">class</span> <span class="nc">geometricAdvancedSettings</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;advanced settings for the geometric route</span>
<span class="sd">       set pulling direction, non-standard solvent</span>
<span class="sd">       and number of stratification windows</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initUI</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initSingalsSlots</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;Geometric advanced settings&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1">#self.show()</span>

    <span class="k">def</span> <span class="nf">_initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize UI for the geometric advanced settings</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="c1"># user-defined pulling direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userDefinedDirection</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;User-defined pulling direction&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userDefinedDirectionLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">userDefinedDirectionLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Reference:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userDefinedDirectionLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userDefinedDirectionLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">userDefinedDirectionLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userDefinedDirectionLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">userDefinedDirectionLineEdit</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">userDefinedDirection</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">userDefinedDirectionLayout</span><span class="p">)</span>

        <span class="c1"># non-standard solvent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolvent</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;User-provided large box&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPsfLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;psf/parm file:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPsfLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPsfButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPdbLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;pdb/rst7 file:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPdbLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPdbButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPsfLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPsfLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPsfButton</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPdbLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPdbLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPdbButton</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolvent</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventLayout</span><span class="p">)</span>

        <span class="c1"># stratification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratification</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Stratification windows&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationRMSDBoundLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;RMSD(Bound):&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationRMSDBoundLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationTheta</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Theta:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationThetaLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationPhiLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Phi:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationPhiLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationPsiLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Psi:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationPsiLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationthetaLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;theta:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationthetaLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationphiLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;phi:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationphiLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationRLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;r:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationRLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationRMSDUnboundLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;RMSD(Unbound):&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationRMSDUnboundLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationRMSDBoundLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationRMSDBoundLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationTheta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationThetaLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationPhiLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationPhiLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationPsiLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationPsiLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationthetaLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationthetaLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationphiLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationphiLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationRLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationRLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationRMSDUnboundLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationRMSDUnboundLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stratification</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="p">)</span>
        
        <span class="c1"># pinning down the protein</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pinDownPro</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Pinning down the protein&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pinDownProLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">pinDownProCheckbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s1">&#39;Pinning down the protein&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pinDownProCheckbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pinDownProLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pinDownProCheckbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pinDownPro</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pinDownProLayout</span><span class="p">)</span>

        <span class="c1"># membrane protein</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modeling</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Modeling (avaiable for CHARMM FF)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modelingLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">memProCheckbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s1">&#39;Membrane protein&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memProCheckbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Auto-neutralize ligand-only system by:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;NaCl&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;KCl&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;CaCl2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">modelingLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memProCheckbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modelingLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modeling</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modelingLayout</span><span class="p">)</span>

        <span class="c1"># parallel runs for error estimation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parallelRuns</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Parallel runs&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parallelRunsLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parallelRunsLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Number of parallel runs: &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parallelRunsLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parallelRunsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallelRunsLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parallelRunsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallelRunsLineEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parallelRuns</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallelRunsLayout</span><span class="p">)</span>
        

        <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettingsButtonLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettingsOKButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;OK&#39;</span><span class="p">)</span>
        <span class="c1">#self.geometricAdvancedSettingsCancelButton = QPushButton(&#39;Cancel&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettingsButtonLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QSplitter</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettingsButtonLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettingsOKButton</span><span class="p">)</span>
        <span class="c1">#self.geometricAdvancedSettingsButtonLayout.addWidget(self.geometricAdvancedSettingsCancelButton)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">userDefinedDirection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolvent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratification</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pinDownPro</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeling</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallelRuns</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettingsButtonLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initSingalsSlots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize (connect) signial and slots for geometric advanced settings</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPsfButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span>
                <span class="s1">&#39;psf/parm/top&#39;</span><span class="p">,</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPsfLineEdit</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPdbButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span>
                <span class="s1">&#39;pdb/gro&#39;</span><span class="p">,</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">nonStandardSolventPdbLineEdit</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettingsOKButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span></div>


<div class="viewcode-block" id="alchemicalAdvancedSettings"><a class="viewcode-back" href="../../BFEE2.gui.html#BFEE2.gui.alchemicalAdvancedSettings">[docs]</a><span class="k">class</span> <span class="nc">alchemicalAdvancedSettings</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;advanced settings for the alchemical route</span>
<span class="sd">       set the number of stratification windows</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initUI</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initSingalsSlots</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;Alchemical advanced settings&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1">#self.show()</span>

    <span class="k">def</span> <span class="nf">_initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize UI for the alchemical advanced settings</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="c1"># stratification windows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratification</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Stratification windows&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">boundLigandLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Ligand/Bound state:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundLigandLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;50&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unboundLigandLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Ligand/Unbound state:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unboundLigandLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;20&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundRestraintsLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Restraints/Bound state:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundRestraintsLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;50&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unboundRestraintsLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Restraints/Unbound state:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unboundRestraintsLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;20&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundLigandLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundLigandLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unboundLigandLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unboundLigandLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundRestraintsLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundRestraintsLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unboundRestraintsLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unboundRestraintsLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stratification</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratificationLayout</span><span class="p">)</span>

        <span class="c1"># double-wide simulation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleWide</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Double-wide simulation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleWideLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">doubleWideCheckbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s1">&#39;Generate input files for double-wide simulations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleWideCheckbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleWideLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleWideCheckbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doubleWide</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleWideLayout</span><span class="p">)</span>

        <span class="c1"># minimize before sampling in each window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minBeforeSample</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Minimization before sampling&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minBeforeSampleLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minBeforeSampleCheckbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s1">&#39;Minimize before sampling in each window&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minBeforeSampleCheckbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minBeforeSampleLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minBeforeSampleCheckbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minBeforeSample</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minBeforeSampleLayout</span><span class="p">)</span>
        
        <span class="c1"># pinning down the protein</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pinDownPro</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Pinning down the protein&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pinDownProLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">pinDownProCheckbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s1">&#39;Pinning down the protein&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pinDownProCheckbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pinDownProLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pinDownProCheckbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pinDownPro</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pinDownProLayout</span><span class="p">)</span>

        <span class="c1"># membrane protein</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modeling</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Modeling (avaiable for CHARMM FF)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modelingLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">memProCheckbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s1">&#39;Membrane protein&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memProCheckbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Auto-neutralize ligand-only system by:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;NaCl&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;KCl&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;CaCl2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">modelingLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memProCheckbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modelingLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neutralizeLigOnlyLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modeling</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modelingLayout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettingsButtonLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettingsOKButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;OK&#39;</span><span class="p">)</span>
        <span class="c1">#self.alchemicalAdvancedSettingsCancelButton = QPushButton(&#39;Cancel&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettingsButtonLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QSplitter</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettingsButtonLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettingsOKButton</span><span class="p">)</span>
        <span class="c1">#self.alchemicalAdvancedSettingsButtonLayout.addWidget(self.alchemicalAdvancedSettingsCancelButton)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratification</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleWide</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pinDownPro</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minBeforeSample</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeling</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettingsButtonLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initSingalsSlots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize (connect) signals and slots for the alchemical advanced settings</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettingsOKButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span></div>

<div class="viewcode-block" id="mainUI"><a class="viewcode-back" href="../../BFEE2.gui.html#BFEE2.gui.mainUI">[docs]</a><span class="k">class</span> <span class="nc">mainUI</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;the main window UI </span>
<span class="sd">       include the preTreatment, postTreatment and QuickPlot tab</span>
<span class="sd">       the preTreatment tab include NAMD and Gromacs tab</span>
<span class="sd">       the postTreatment tab include geometric and alchemical tab</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_initActions</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_initNAMDTab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initGromacsTab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initPreTreatmentTab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initQuickPlotTab</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_initGeometricTab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initAlchemicalTab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initPostTreatmentTab</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_initSingalsSlots</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_initMainUI</span><span class="p">()</span>

        <span class="c1"># other dialogs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainSettings</span> <span class="o">=</span> <span class="n">mainSettings</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettings</span> <span class="o">=</span> <span class="n">alchemicalAdvancedSettings</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span> <span class="o">=</span> <span class="n">geometricAdvancedSettings</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">__PROGRAM_NAME__</span><span class="p">)</span>    
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_initActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; initialize actions for menubar &#39;&#39;&#39;</span>

        <span class="c1"># settings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settingsAction</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s1">&#39;&amp;Settings&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settingsAction</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s1">&#39;Set pathes for third-party softwares&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settingsAction</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mainSettings</span><span class="p">())</span>

        <span class="c1"># exit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exitAction</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s1">&#39;&amp;Exit&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">exitAction</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s1">&#39;Exit application&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exitAction</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">QApplication</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>

        <span class="c1"># help</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpAction</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s1">&#39;&amp;Help&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpAction</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s1">&#39;Open user manual&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpAction</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_openDocFile</span><span class="p">)</span>

        <span class="c1"># python API</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pythonAPIAction</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s1">&#39;&amp;Python API&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pythonAPIAction</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s1">&#39;Open Python API Documentation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pythonAPIAction</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_openPythonAPIFile</span><span class="p">)</span>

        <span class="c1"># about</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aboutAction</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s1">&#39;&amp;About&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aboutAction</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s1">&#39;About BFEEstimator&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aboutAction</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_showAboutBox</span><span class="p">())</span>

        
    <span class="k">def</span> <span class="nf">_initMainUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize main window</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># status bar</span>
        <span class="c1">#self.statusBar()</span>

        <span class="c1"># menu bar</span>
        <span class="n">menubar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span>
        <span class="n">menubar</span><span class="o">.</span><span class="n">setNativeMenuBar</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s1">&#39;&amp;File&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsAction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exitAction</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s1">&#39;&amp;Help&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">helpAction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pythonAPIAction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aboutAction</span><span class="p">)</span>

        <span class="c1"># main layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="c1"># title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Binding Free Energy Estimator&#39;</span><span class="p">)</span>
        <span class="n">titleFont</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">()</span>
        <span class="n">titleFont</span><span class="o">.</span><span class="n">setBold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">titleFont</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">titleBox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">titleBoxLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">titleBoxLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">titleBox</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">titleBoxLayout</span><span class="p">)</span>

        <span class="c1"># tabs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainTabs</span> <span class="o">=</span> <span class="n">QTabWidget</span><span class="p">()</span>
        <span class="c1">#self.preTreatmentTab = QWidget()</span>
        <span class="c1">#self.postTreatmentTab = QWidget()</span>
        <span class="c1">#self.quickPlot = QWidget()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainTabs</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentTab</span><span class="p">,</span> <span class="s1">&#39;Pre-treatment&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainTabs</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postTreatmentTab</span><span class="p">,</span> <span class="s1">&#39;Post-treatment&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainTabs</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quickPlot</span><span class="p">,</span> <span class="s1">&#39;Quick-Plot&#39;</span><span class="p">)</span>

        <span class="c1"># main layout</span>
        <span class="c1">#self.mainLayout.addWidget(self.titleBox)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainTabs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWidgit</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWidgit</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWidgit</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initPreTreatmentTab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize pre-treatment tab</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentTab</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        
        <span class="c1"># pre-treatment tabs</span>
        <span class="c1"># NAMD and gromacs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentMainTabs</span> <span class="o">=</span> <span class="n">QTabWidget</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentMainTabs</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NAMDTab</span><span class="p">,</span> <span class="s1">&#39;NAMD&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentMainTabs</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GromacsTab</span><span class="p">,</span> <span class="s1">&#39;Gromacs&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentMainLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentMainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentMainTabs</span><span class="p">)</span>

        <span class="c1"># other parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">otherParameters</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Other parameters&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">otherParametersLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="c1"># temperature, selection protein and ligand layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">otherParametersChildLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="c1"># temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperatureLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Temperature:      &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperatureLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;300&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">otherParametersChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperatureLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">otherParametersChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperatureLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># select protein</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectProteinLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Select protein:   &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectProteineLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;segid SH3D&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">otherParametersChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectProteinLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">otherParametersChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectProteineLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># select ligand</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectLigandLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Select ligand:    &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectLigandLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;segid PPRO&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">otherParametersChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectLigandLabel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">otherParametersChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectLigandLineEdit</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># select strategy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Select strategy:  &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyCombobox</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyCombobox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;Geometric&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyCombobox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;Alchemical&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyAdvancedButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Advanced settings&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyChildLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyCombobox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyAdvancedButton</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyChildLayout</span><span class="p">)</span>
        

        <span class="c1"># generate input button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generateInputButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Generate Inputs&#39;</span><span class="p">)</span>
 
        <span class="bp">self</span><span class="o">.</span><span class="n">otherParametersLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">otherParametersChildLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">otherParametersLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">otherParameters</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">otherParametersLayout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentMainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">otherParameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentMainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generateInputButton</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentTab</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentMainLayout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initNAMDTab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize NAMD Tab in pre-treatment Tab</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">NAMDTab</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NAMDTabMainLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="c1"># inputs for the complex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputsForComplex</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Inputs for complex&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputsForComplexLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="c1"># psf/parm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psfLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;psf/parm file:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psfLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psfButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputsForComplexLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psfLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputsForComplexLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psfLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputsForComplexLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psfButton</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># coor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coorLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;pdb/rst file:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coorLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coorButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputsForComplexLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coorLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputsForComplexLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coorLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputsForComplexLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coorButton</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># force fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFields</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Force fields&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldsLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="c1"># force field type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldTypeLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldTypeLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Force field type:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldCombobox</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldCombobox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;CHARMM&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldCombobox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;Amber&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldTypeLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFieldTypeLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldTypeLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFieldCombobox</span><span class="p">)</span>

        <span class="c1"># CHARMM force field files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Force field files:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesBox</span> <span class="o">=</span> <span class="n">QListWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesChildLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldAddButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldClearButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Clear&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFieldAddButton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFieldClearButton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesBox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesChildLayout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldsLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFieldTypeLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldsLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesLayout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputsForComplex</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputsForComplexLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFields</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFieldsLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NAMDTabMainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputsForComplex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NAMDTabMainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFields</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NAMDTab</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NAMDTabMainLayout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initGromacsTab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize GMX Tab in pre-treatment Tab</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsTab</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsTabMainLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="c1"># inputs for the complex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsForComplex</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Inputs for complex&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsForComplexLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="c1"># top</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;top file: &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsForComplexLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsForComplexLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsForComplexLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topButton</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># gro</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsPdbLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;pdb file: &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsPdbLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsPdbButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsForComplexLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gromacsPdbLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsForComplexLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gromacsPdbLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsForComplexLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gromacsPdbButton</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsForComplexLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QSplitter</span><span class="p">(),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsForComplex</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsForComplexLayout</span><span class="p">)</span>

        <span class="c1"># inputs for the ligand-only system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsLigandOnly</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Inputs for ligand-only system&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsLigandOnlyLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="c1"># top</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyTopLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;top file: &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyTopLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyTopButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsLigandOnlyLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyTopLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsLigandOnlyLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyTopLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsLigandOnlyLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyTopButton</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># gro</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyPdbLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;pdb file: &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyPdbLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyPdbButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsLigandOnlyLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyPdbLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsLigandOnlyLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyPdbLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsLigandOnlyLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyPdbButton</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsLigandOnlyLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QSplitter</span><span class="p">(),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsLigandOnly</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsLigandOnlyLayout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsTabMainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsForComplex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsTabMainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GromacsInputsLigandOnly</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">GromacsTab</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GromacsTabMainLayout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initPostTreatmentTab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize pre-treatment tab</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">postTreatmentTab</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>

        <span class="c1"># post-treatment tabs</span>
        <span class="c1"># Geometric and alchemical</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postTreatmentMainTabs</span> <span class="o">=</span> <span class="n">QTabWidget</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">postTreatmentMainTabs</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometricTab</span><span class="p">,</span> <span class="s1">&#39;Geometric&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postTreatmentMainTabs</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalTab</span><span class="p">,</span> <span class="s1">&#39;Alchemical&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">postTreatmentMainLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postTreatmentMainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postTreatmentMainTabs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Calculate binding free energy&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postTreatmentMainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculateButton</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">postTreatmentTab</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postTreatmentMainLayout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initGeometricTab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize geometric tab of post-treatment</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">geometricTab</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometricTabLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="c1"># pmf inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pmfInputs</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;PMF inputs (.czar.pmf/.UI.pmf):&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pmfInputsLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="c1"># bound stats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Bound state:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="c1"># RMSD</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsdBoundLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;RMSD: &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsdBoundLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsdBoundButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmsdBoundLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmsdBoundLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmsdBoundButton</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ThetaLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Theta:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ThetaLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ThetaButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ThetaLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ThetaLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ThetaButton</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Phi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PhiLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Phi:  &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PhiLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PhiButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PhiLabel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PhiLineEdit</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PhiButton</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Psi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PsiLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Psi:  &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PsiLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PsiButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PsiLabel</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PsiLineEdit</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PsiButton</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thetaLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thetaLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;theta:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thetaLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thetaButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thetaLabel</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thetaLineEdit</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thetaButton</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># phi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phiLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phiLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;phi:  &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phiLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phiButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phiLabel</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phiLineEdit</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phiButton</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># r</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;r:    &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rLabel</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rLineEdit</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rButton</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">unboundStateLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Unbound state:&#39;</span><span class="p">)</span>

        <span class="c1"># RMSD unbound</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;RMSD: &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundLineEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundButton</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pmfInputsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundStateLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pmfInputsLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundStateLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pmfInputsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unboundStateLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pmfInputsLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundLayout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pmfInputs</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pmfInputsLayout</span><span class="p">)</span>

        <span class="c1"># force constants</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstants</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Force constants (in Colvars unit):&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fcBoundStateLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Bound state:&#39;</span><span class="p">)</span>

        <span class="c1"># all widgets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcRMSDLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;RMSD:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcRMSDLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;10&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcThetaLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Theta:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcThetaLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcPhiLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Phi:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcPhiLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcPsiLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Psi:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcPsiLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcthetaLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;theta:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcthetaLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcphiLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;phi:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcphiLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcRMSDLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcRMSDLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcThetaLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcThetaLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcPhiLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcPhiLineEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcPsiLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcPsiLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcthetaLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcthetaLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcphiLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcphiLineEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">forceConstants</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceConstantsLayout</span><span class="p">)</span>

        <span class="c1"># other parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postOtherParams</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Other parameters:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postOtherParamsLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">postTemperatureLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;temperature:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postTemperatureLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;300&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postRstarLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39; r*:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postRstarLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;30&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postPMFTypeLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39; PMF type:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postPMFTypeBox</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postPMFTypeBox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;NAMD&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postPMFTypeBox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;Gromacs&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">postOtherParamsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postTemperatureLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postOtherParamsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postTemperatureLineEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postOtherParamsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postRstarLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postOtherParamsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postRstarLineEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postOtherParamsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postPMFTypeLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postOtherParamsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postPMFTypeBox</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">postOtherParams</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postOtherParamsLayout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fcBoundStateLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Bound state:&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">geometricTabLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pmfInputs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometricTabLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceConstants</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometricTabLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postOtherParams</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometricTab</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometricTabLayout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initAlchemicalTab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize alchemical tab of post-treatment</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalTab</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalTabLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        
        <span class="bp">self</span><span class="o">.</span><span class="n">restraintInputs</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Inputs for alchemical simulations (.fepout/.log):&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restraintInputsLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="c1"># bound state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Atoms/Bound state (.fepout):&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLabel1</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Forward:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit1</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardButton1</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLabel1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardButton1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLabel1</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Backward:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit1</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardButton1</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLabel1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardButton1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLabel2</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Restraints/Bound state (.log):&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout2</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLabel2</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Forward:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit2</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardButton2</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLabel2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardButton2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLabel2</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Backward:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit2</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardButton2</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLabel2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardButton2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># unbound state</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Atoms/Unbound state (.fepout):&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLabel3</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Forward:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit3</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardButton3</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLabel3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardButton3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLabel3</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Backward:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit3</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardButton3</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLabel3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardButton3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLabel2</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Restraints/Unbound state (.log):&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout2</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLabel4</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Forward:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit4</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardButton4</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLabel4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardButton4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLabel4</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Backward:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit4</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardButton4</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLabel4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardButton4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">restraintInputsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restraintInputsLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restraintInputsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLabel2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restraintInputsLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBoundStateLayout2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restraintInputsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restraintInputsLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restraintInputsLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLabel2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restraintInputsLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalUnboundStateLayout2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restraintInputs</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">restraintInputsLayout</span><span class="p">)</span>

        <span class="c1"># alchemical force constants</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForceConstants</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Force constants (in Colvars unit):&#39;</span><span class="p">)</span>

        <span class="c1"># all widgets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcThetaLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Theta:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcThetaLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcPhiLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39; Phi: &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcPhiLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcPsiLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Psi:  &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcPsiLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcthetaLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;theta:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcthetaLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcphiLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39; phi: &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcphiLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcRLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;r: &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcRLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;10&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcThetaLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcThetaLineEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcPhiLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcPhiLineEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcPsiLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcPsiLineEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcthetaLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcthetaLineEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcphiLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcphiLineEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcRLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcRLineEdit</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForceConstants</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalFCLayout</span><span class="p">)</span>

        <span class="c1"># alchemical restraint centers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRestraintCenters</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Restraint centers (in Colvars unit) and temperature:&#39;</span><span class="p">)</span>

        <span class="c1"># all widgets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCThetaLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Theta:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCThetaLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCthetaLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;theta:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCthetaLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;90&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCRLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;r: &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCRLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;8&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalPostTemperatureLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;temperature:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalPostTemperatureLineEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;300&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCThetaLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCThetaLineEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCthetaLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCthetaLineEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCRLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCRLineEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalPostTemperatureLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalPostTemperatureLineEdit</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRestraintCenters</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCLayout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalTabLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">restraintInputs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalTabLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForceConstants</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalTabLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRestraintCenters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalTab</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalTabLayout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initQuickPlotTab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize quick-plot tab</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">quickPlot</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quickPlotLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="c1"># plot a (stratified) pmf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmf</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Plot (stratified) PMFs:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;PMF files:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfBox</span> <span class="o">=</span> <span class="n">QListWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfChildLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfAddButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfClearButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Clear&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfPlotButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfAddButton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfClearButton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfPlotButton</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfBox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfChildLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmf</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfLayout</span><span class="p">)</span>

        <span class="c1"># calculate pmf RMSD convergence</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergence</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Calculate PMF RMSD convergence:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;history file:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceBox</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceChildLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceBrowseButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Browse&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergencePlotButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceBrowseButton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergencePlotButton</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceBox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceChildLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergence</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceLayout</span><span class="p">)</span>

        <span class="c1"># merge a (stratified) pmf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmf</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s1">&#39;Merge (stratified) PMFs:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;PMF files:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfBox</span> <span class="o">=</span> <span class="n">QListWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfChildLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfAddButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfClearButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Clear&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfmergeButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Merge&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mergePmfAddButton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mergePmfClearButton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfChildLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mergePmfmergeButton</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mergePmfLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mergePmfBox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mergePmfChildLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmf</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mergePmfLayout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">quickPlotLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quickPlotLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mergePmf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quickPlotLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quickPlot</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quickPlotLayout</span><span class="p">)</span>

    <span class="c1"># slots are defined below</span>
    <span class="c1"># otherwise they are defined in slots.py</span>
    <span class="k">def</span> <span class="nf">_mainSettings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;call main settings</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainSettings</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">f</span>

    <span class="k">def</span> <span class="nf">_advancedSettings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comboBox</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;call advanced settings in pre-treatment</span>
<span class="sd">           the returned function is depended on the comboBox(strategy type)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Geometric&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Alchemical&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettings</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">f</span>

    <span class="k">def</span> <span class="nf">_changeFFButtonState</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;enable/disable the add and clear button of force field section</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldCombobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;CHARMM&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldAddButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldClearButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldCombobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Amber&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldAddButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldClearButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_openDocFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;open Documentation file</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s1">&#39;Doc.pdf&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">docFile</span><span class="p">:</span>
            <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;file:///&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">docFile</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_openPythonAPIFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;open Python API Documentation file</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s1">&#39;PythonAPI.pdf&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pythonAPIFile</span><span class="p">:</span>
            <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;file:///&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pythonAPIFile</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_showAboutBox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;the about message box</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            function obj: a slot function that shows that about message box</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="s1">&#39;About&#39;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s1">&#39;&lt;center&gt;&lt;b&gt;</span><span class="si">{</span><span class="n">__PROGRAM_NAME__</span><span class="si">}</span><span class="s1">&lt;/b&gt;&lt;/center&gt;&lt;br&gt;&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">                Binding free energy estimator (BFEE) is a python-based software</span>
<span class="s1">                that automates absolute binding free energy calculations through</span>
<span class="s1">                either the alchemical or geometric route by molecular dynamics</span>
<span class="s1">                simulations.&lt;br&gt;</span>
<span class="s1">                &lt;b&gt;Authors:&lt;/b&gt;&lt;br&gt;</span>
<span class="s1">                Haohao Fu (&lt;a href=&quot;mailto:fhh2626@gmail.com&quot;&gt;fhh2626@gmail.com&lt;/a&gt;)&lt;br&gt;</span>
<span class="s1">                Haochuan Chen (&lt;a href=&quot;mailto:summersnow9403@gmail.com&quot;&gt;summersnow9403@gmail.com&lt;/a&gt;)&lt;br&gt;</span>
<span class="s1">                &lt;b&gt;License:&lt;/b&gt;&lt;br&gt;</span>
<span class="s1">                BFEE2 is free software: you can redistribute it and/or modify it</span>
<span class="s1">                under the terms of the GNU General Public License as published by</span>
<span class="s1">                the Free Software Foundation, either version 3 of the License, or</span>
<span class="s1">                (at your option) any later version.&lt;br&gt;</span>
<span class="s1">                &lt;b&gt;Contact&lt;/b&gt; Wensheng Cai (&lt;a href=&quot;mailto:wscai@nankai.edu.cn&quot;&gt;wscai@nankai.edu.cn&lt;/a&gt;)</span>
<span class="s1">                and Chris Chipot (&lt;a href=&quot;mailto:chipot@ks.uiuc.edu&quot;&gt;chipot@ks.uiuc.edu&lt;/a&gt;)</span>
<span class="s1">                for further copyright information.</span>
<span class="s1">                &#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span>

    <span class="k">def</span> <span class="nf">_showGeometricResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; calculate binding from the geometric route,</span>
<span class="sd">            parameters in the Geometric tab will be read.</span>
<span class="sd">            Show a QMessageBox for the result</span>
<span class="sd">            Inputs:</span>
<span class="sd">                unit (string): &#39;namd&#39; or &#39;gromacs&#39; &#39;&#39;&#39;</span>
        
        <span class="n">pTreat</span> <span class="o">=</span> <span class="n">postTreatment</span><span class="o">.</span><span class="n">postTreatment</span><span class="p">(</span>
            <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postTemperatureLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="n">unit</span><span class="p">,</span> <span class="s1">&#39;geometric&#39;</span><span class="p">)</span>
            
        <span class="n">pmfs</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rmsdBoundLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">ThetaLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">PhiLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">PsiLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">thetaLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">phiLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">rLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="p">]</span>
            
        <span class="k">try</span><span class="p">:</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcRMSDLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> 
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcThetaLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> 
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcPhiLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> 
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcPsiLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcthetaLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> 
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcphiLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> 
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postRstarLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> 
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcRMSDLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Force constant or r* input error!&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># check inputs</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">pmfs</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;file </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1"> does not exist!&#39;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="c1"># calculate free energies</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">pTreat</span><span class="o">.</span><span class="n">geometricBindingFreeEnergy</span><span class="p">(</span><span class="n">pmfs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s1">&#39;Result&#39;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">Results:</span><span class="se">\n\</span>
<span class="s1">ΔG(site,c)            = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="s1">ΔG(site,eulerTheta)   = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="s1">ΔG(site,eulerPhi)     = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="s1">ΔG(site,eulerPsi)     = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="s1">ΔG(site,polarTheta)   = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="s1">ΔG(site,polarPhi)     = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="s1">(1/beta)*ln(S*I*C0)   = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="s1">ΔG(bulk,c)            = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="s1">ΔG(bulk,o)            = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="se">\n\</span>
<span class="s1">Standard Binding Free Energy:</span><span class="se">\n\</span>
<span class="s1">ΔG(total)             = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showAlchemicalResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;calculate binding from the alchemical route,</span>
<span class="sd">            parameters in the alchemical tab will be read.</span>
<span class="sd">            Show a QMessageBox for the result</span>

<span class="sd">        Args:</span>
<span class="sd">            unit (str): &#39;namd&#39; or &#39;gromacs&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">pTreat</span> <span class="o">=</span> <span class="n">postTreatment</span><span class="o">.</span><span class="n">postTreatment</span><span class="p">(</span>
            <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalPostTemperatureLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="n">unit</span><span class="p">,</span> <span class="s1">&#39;geometric&#39;</span><span class="p">)</span>
        
        <span class="c1"># alchemical outputs</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit1</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit1</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit2</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit2</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit3</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit3</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit4</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit4</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="p">]</span>
            
        <span class="k">try</span><span class="p">:</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCThetaLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> 
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCthetaLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> 
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalRCRLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> 
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcThetaLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcPhiLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> 
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcPsiLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> 
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcthetaLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> 
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcphiLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalfcRLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Force constant or restraint center input error!&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># check inputs</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit1</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit2</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit3</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit4</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="p">]:</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">item</span><span class="p">))</span> <span class="ow">and</span> <span class="n">item</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;backward file </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1"> does not exist and is not empty!&#39;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit1</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit2</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit3</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit4</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
        <span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;file </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1"> does not exist!&#39;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="c1"># calculate free energies</span>
        <span class="n">result</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">pTreat</span><span class="o">.</span><span class="n">alchemicalBindingFreeEnergy</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s1">&#39;Result&#39;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">Results:</span><span class="se">\n\</span>
<span class="s1">ΔG(site,couple)   = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> ± </span><span class="si">{</span><span class="n">errors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="s1">ΔG(site,c+o+a+r)  = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> ± </span><span class="si">{</span><span class="n">errors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="s1">ΔG(bulk,decouple) = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> ± </span><span class="si">{</span><span class="n">errors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="s1">ΔG(bulk,c)        = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> ± </span><span class="si">{</span><span class="n">errors</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="s1">ΔG(bulk,o+a+r)    = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n\</span>
<span class="se">\n\</span>
<span class="s1">Standard Binding Free Energy:</span><span class="se">\n\</span>
<span class="s1">ΔG(total)         = </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> ± </span><span class="si">{</span><span class="n">errors</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showFinalResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;calculate binding free energy and show the final results</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            function obj: a slot function that calculates binding free energy and show the final results</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">postPMFTypeBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;NAMD&#39;</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;namd&#39;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">postPMFTypeBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Gromacs&#39;</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;gromacs&#39;</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">postTreatmentMainTabs</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">jobType</span> <span class="o">=</span> <span class="s1">&#39;geometric&#39;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">postTreatmentMainTabs</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">jobType</span> <span class="o">=</span> <span class="s1">&#39;alchemical&#39;</span>

            <span class="k">if</span> <span class="n">jobType</span> <span class="o">==</span> <span class="s1">&#39;geometric&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_showGeometricResults</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">jobType</span> <span class="o">==</span> <span class="s1">&#39;alchemical&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_showAlchemicalResults</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">f</span>

    <span class="k">def</span> <span class="nf">_generateInputFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;generate input files for binding free energy simulation</span>
<span class="sd">        </span>
<span class="sd">        Returens:</span>
<span class="sd">            function obj: a slot function that generates input files for binding free energy simulation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Select a directory&#39;</span><span class="p">)</span>
            <span class="c1"># cancel</span>
            <span class="k">if</span> <span class="n">path</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="n">iGenerator</span> <span class="o">=</span> <span class="n">inputGenerator</span><span class="o">.</span><span class="n">inputGenerator</span><span class="p">()</span>

            <span class="c1"># third-party softwares and user-provided solvation boxes</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mainSettings</span><span class="o">.</span><span class="n">vmdLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                <span class="c1">#self.mainSettings.gromacsLineEdit.text(),</span>
                <span class="c1">#self.mainSettings.tleapLineEdit.text(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">nonStandardSolventPdbLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">nonStandardSolventPsfLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="p">]:</span>
                <span class="k">if</span> <span class="p">((</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">item</span><span class="p">))</span> <span class="ow">and</span> <span class="n">item</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;file </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1"> does not exist!&#39;</span><span class="p">)</span>
                    <span class="k">return</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentMainTabs</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># force fields</span>
                <span class="n">forceFieldFiles</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesBox</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesBox</span><span class="o">.</span><span class="n">count</span><span class="p">())]</span>

                <span class="c1"># NAMD files</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">psfLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">coorLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()]</span> <span class="o">+</span> <span class="n">forceFieldFiles</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;file </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1"> does not exist!&#39;</span><span class="p">)</span>
                        <span class="k">return</span>

                <span class="c1"># check inputs</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperatureLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                    <span class="n">stratification</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">stratificationRMSDBoundLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">stratificationThetaLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">stratificationPhiLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">stratificationPsiLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">stratificationthetaLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">stratificationphiLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">stratificationRLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">stratificationRMSDUnboundLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                    <span class="p">]</span>
                    <span class="n">alchemicalStratification</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettings</span><span class="o">.</span><span class="n">boundLigandLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettings</span><span class="o">.</span><span class="n">boundRestraintsLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettings</span><span class="o">.</span><span class="n">unboundLigandLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettings</span><span class="o">.</span><span class="n">unboundRestraintsLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                    <span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Force constant or r* input error!&#39;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="c1"># job type</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldCombobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;CHARMM&#39;</span><span class="p">:</span>
                    <span class="n">forceFieldType</span> <span class="o">=</span> <span class="s1">&#39;charmm&#39;</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldCombobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Amber&#39;</span><span class="p">:</span>
                    <span class="n">forceFieldType</span> <span class="o">=</span> <span class="s1">&#39;amber&#39;</span>

                <span class="c1"># make sure there are CHARMM FF files</span>
                <span class="k">if</span> <span class="n">forceFieldFiles</span> <span class="o">==</span> <span class="p">[]</span> <span class="ow">and</span> <span class="n">forceFieldType</span> <span class="o">==</span> <span class="s1">&#39;charmm&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">CHARMM force field files must be specified!&#39;</span>
                        <span class="p">)</span>
                    <span class="k">return</span>
                
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyCombobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Geometric&#39;</span><span class="p">:</span>

                    <span class="c1"># for the amber force field, files of large box must be provided</span>
                    <span class="k">if</span> <span class="n">forceFieldType</span> <span class="o">==</span> <span class="s1">&#39;amber&#39;</span><span class="p">:</span>

                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">nonStandardSolventPdbLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">nonStandardSolventPsfLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">Coordinate and topology files of large box must be </span><span class="se">\</span>
<span class="s1">provided in &quot;Advanced Settings&quot;when using the Amber </span><span class="se">\</span>
<span class="s1">force fields!&#39;</span>
                            <span class="p">)</span>
                            <span class="k">return</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">iGenerator</span><span class="o">.</span><span class="n">generateNAMDGeometricFiles</span><span class="p">(</span>
                            <span class="n">path</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">psfLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">coorLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="n">forceFieldType</span><span class="p">,</span>
                            <span class="n">forceFieldFiles</span><span class="p">,</span>
                            <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperatureLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">selectProteineLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">selectLigandLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">userDefinedDirectionLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">nonStandardSolventPsfLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">nonStandardSolventPdbLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="n">stratification</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">memProCheckbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">pinDownProCheckbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                            <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">parallelRunsLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">mainSettings</span><span class="o">.</span><span class="n">vmdLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                        <span class="p">)</span>
                    <span class="k">except</span> <span class="n">fileParser</span><span class="o">.</span><span class="n">SelectionError</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">Selection corresponding to nothing!</span><span class="se">\n\</span>
<span class="s1">Check your selection again!&#39;</span>
                        <span class="p">)</span>
                        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/BFEE&#39;</span><span class="p">):</span>
                            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/BFEE&#39;</span><span class="p">)</span>
                        <span class="k">return</span>
                    <span class="k">except</span> <span class="n">inputGenerator</span><span class="o">.</span><span class="n">DirectoryExistError</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">./BFEE* directory already exists!&#39;</span>
                        <span class="p">)</span>
                        <span class="k">return</span>
                    <span class="k">except</span> <span class="n">inputGenerator</span><span class="o">.</span><span class="n">FileTypeUnknownError</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">Unkwn input file types! The following file types are supported:</span><span class="se">\n\</span>
<span class="s1">psf, parm, prm7, parm7, prmtop, pdb, coor, rst, rst7, inpcrd &#39;</span>
                        <span class="p">)</span>
                        <span class="k">return</span>
                    <span class="k">except</span> <span class="ne">PermissionError</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">Cannot read input files due to the permission reason!</span><span class="se">\n\</span>
<span class="s1">Restart the program or check the authority of the files!&#39;</span>
                        <span class="p">)</span>
                        <span class="k">return</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">Unknown error! The error message is: </span><span class="se">\n\</span>
<span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="p">)</span>
                        <span class="k">return</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyCombobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Alchemical&#39;</span><span class="p">:</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">iGenerator</span><span class="o">.</span><span class="n">generateNAMDAlchemicalFiles</span><span class="p">(</span>
                            <span class="n">path</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">psfLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">coorLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="n">forceFieldType</span><span class="p">,</span>
                            <span class="n">forceFieldFiles</span><span class="p">,</span>
                            <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperatureLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">selectProteineLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">selectLigandLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="n">alchemicalStratification</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettings</span><span class="o">.</span><span class="n">doubleWideCheckbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettings</span><span class="o">.</span><span class="n">minBeforeSampleCheckbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettings</span><span class="o">.</span><span class="n">memProCheckbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">geometricAdvancedSettings</span><span class="o">.</span><span class="n">neutralizeLigOnlyCombobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalAdvancedSettings</span><span class="o">.</span><span class="n">pinDownProCheckbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">mainSettings</span><span class="o">.</span><span class="n">vmdLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                        <span class="p">)</span>
                    <span class="k">except</span> <span class="ne">PermissionError</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">Cannot read input files due to the permission reason!</span><span class="se">\n\</span>
<span class="s1">Restart the program or check the authority of the files!&#39;</span>
                        <span class="p">)</span>
                        <span class="k">return</span>
                    <span class="k">except</span> <span class="n">fileParser</span><span class="o">.</span><span class="n">SelectionError</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">Selection corresponding to nothing!</span><span class="se">\n\</span>
<span class="s1">Check your selection again!&#39;</span>
                        <span class="p">)</span>
                        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/BFEE&#39;</span><span class="p">):</span>
                            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/BFEE&#39;</span><span class="p">)</span>
                        <span class="k">return</span>
                    <span class="k">except</span> <span class="n">inputGenerator</span><span class="o">.</span><span class="n">DirectoryExistError</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">./BFEE directory already exists!&#39;</span>
                        <span class="p">)</span>
                        <span class="k">return</span>
                    <span class="k">except</span> <span class="n">inputGenerator</span><span class="o">.</span><span class="n">FileTypeUnknownError</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">Unkwn input file types! The following file types are supported:</span><span class="se">\n\</span>
<span class="s1">psf, parm, prm7, parm7, prmtop, pdb, coor, rst, rst7, inpcrd &#39;</span>
                        <span class="p">)</span>
                        <span class="k">return</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">Unknown error! The error message is: </span><span class="se">\n\</span>
<span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="p">)</span>
                        <span class="k">return</span>

            <span class="c1"># gromacs</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preTreatmentMainTabs</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Warning&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Any setting in &quot;Advanced settings&quot; is not supported by Gromacs!&#39;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">topLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> 
                        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsPdbLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyPdbLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyTopLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                    <span class="p">]:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;file </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1"> does not exist!&#39;</span><span class="p">)</span>
                        <span class="k">return</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyCombobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Geometric&#39;</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>              
                        <span class="n">iGenerator</span><span class="o">.</span><span class="n">generateGromacsGeometricFiles</span><span class="p">(</span>
                            <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                            <span class="n">topFile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">topLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="n">pdbFile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gromacsPdbLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="n">ligandOnlyTopFile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyTopLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="n">ligandOnlyPdbFile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyPdbLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="n">selectionPro</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">selectProteineLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="n">selectionLig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">selectLigandLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                            <span class="n">temperature</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperatureLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                        <span class="p">)</span>
                    <span class="k">except</span> <span class="n">inputGenerator</span><span class="o">.</span><span class="n">DirectoryExistError</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">./BFEE directory already exists!&#39;</span>
                        <span class="p">)</span>
                        <span class="k">return</span>
                    <span class="k">except</span> <span class="n">BFEEGromacs</span><span class="o">.</span><span class="n">SelectionError</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">Selection corresponding to nothing!</span><span class="se">\n\</span>
<span class="s1">Check your selection again!&#39;</span>
                        <span class="p">)</span>
                        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/BFEE&#39;</span><span class="p">):</span>
                            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/BFEE&#39;</span><span class="p">)</span>
                        <span class="k">return</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="bp">self</span><span class="p">,</span> 
                                <span class="s1">&#39;Error&#39;</span><span class="p">,</span> 
                                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">Unknown error!&#39;</span>
                        <span class="p">)</span>
                        <span class="k">return</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyCombobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Alchemical&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Alchemical route is not supported using Gromacs!&#39;</span><span class="p">)</span>
                    <span class="k">return</span>

            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Input generation&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Input files have been generated successfully!&#39;</span><span class="p">)</span>
            
            <span class="k">del</span> <span class="n">iGenerator</span>

        <span class="k">return</span> <span class="n">f</span> 

    <span class="k">def</span> <span class="nf">_mergePMFs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;merge a series of overlapped pmfs</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            function obj: a slot function that merges a series of overlapped pmfs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfBox</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Warning&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Warning, no PMF selected!&#39;</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="n">path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Set the name of merged PMF&#39;</span><span class="p">)</span>

            <span class="n">pmfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ploter</span><span class="o">.</span><span class="n">readPMF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mergePmfBox</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mergePmfBox</span><span class="o">.</span><span class="n">count</span><span class="p">())]</span>

            <span class="n">mergedPMF</span> <span class="o">=</span> <span class="n">ploter</span><span class="o">.</span><span class="n">mergePMF</span><span class="p">(</span><span class="n">pmfs</span><span class="p">)</span>
            <span class="n">ploter</span><span class="o">.</span><span class="n">writePMF</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">mergedPMF</span><span class="p">)</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Merge PMFs&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;PMF merged successfully!&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span>

    <span class="k">def</span> <span class="nf">_plotPMFs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plot a series of overlapped pmfs</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            function obj: a slot function that plots a series of overlapped pmfs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfBox</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Warning&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Warning, no PMF selected!&#39;</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="n">pmfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ploter</span><span class="o">.</span><span class="n">readPMF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfBox</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfBox</span><span class="o">.</span><span class="n">count</span><span class="p">())]</span>

            <span class="n">mergedPMF</span> <span class="o">=</span> <span class="n">ploter</span><span class="o">.</span><span class="n">mergePMF</span><span class="p">(</span><span class="n">pmfs</span><span class="p">)</span>
            <span class="n">ploter</span><span class="o">.</span><span class="n">plotPMF</span><span class="p">(</span><span class="n">mergedPMF</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span>

    <span class="k">def</span> <span class="nf">_plotRMSDConvergence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plot time evolution of PMF rmsd with respect to zero array</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            function obj: a slot function that plots time evolution of PMF rmsd with respect to zero array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceBox</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;file </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1"> does not exist!&#39;</span><span class="p">)</span>
                <span class="k">return</span>
            
            <span class="n">rmsds</span> <span class="o">=</span> <span class="n">ploter</span><span class="o">.</span><span class="n">parseHistFile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">ploter</span><span class="o">.</span><span class="n">plotConvergence</span><span class="p">(</span><span class="n">rmsds</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span>


    <span class="k">def</span> <span class="nf">_initSingalsSlots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize (connect) singals and slots</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># pre-treatment tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyAdvancedButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_advancedSettings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectStrategyCombobox</span><span class="p">))</span>

        <span class="c1"># NAMD tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psfButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;psf/parm&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">psfLineEdit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coorButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;pdb/rst&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coorLineEdit</span><span class="p">))</span>

        <span class="c1"># force field selection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldCombobox</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_changeFFButtonState</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldAddButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFilesDialog</span><span class="p">(</span><span class="s1">&#39;prm&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesBox</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceFieldClearButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forceFieldFilesBox</span><span class="o">.</span><span class="n">clear</span><span class="p">)</span>

        <span class="c1"># gromacs tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsPdbButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;pdb&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gromacsPdbLineEdit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">topLineEdit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyPdbButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;pdb&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyPdbLineEdit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyTopButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gromacsLigandOnlyTopLineEdit</span><span class="p">))</span>

        <span class="c1"># geometric tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsdBoundButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;czar.pmf/UI.pmf&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsdBoundLineEdit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;czar.pmf/UI.pmf&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsdUnboundLineEdit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ThetaButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;czar.pmf/UI.pmf&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ThetaLineEdit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PhiButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;czar.pmf/UI.pmf&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">PhiLineEdit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PsiButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;czar.pmf/UI.pmf&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">PsiLineEdit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thetaButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;czar.pmf/UI.pmf&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">thetaLineEdit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phiButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;czar.pmf/UI.pmf&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phiLineEdit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;czar.pmf/UI.pmf&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rLineEdit</span><span class="p">))</span>

        <span class="c1"># alchemical tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardButton1</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardButton1</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardButton2</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardButton2</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardButton3</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;fepout&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardButton3</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;fepout&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardButton4</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;fepout&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalForwardLineEdit4</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardButton4</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;fepout&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alchemicalBackwardLineEdit4</span><span class="p">))</span>

        <span class="c1"># generate input files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generateInputButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_generateInputFiles</span><span class="p">())</span>

        <span class="c1"># calculate binding free energy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_showFinalResults</span><span class="p">())</span>

        <span class="c1"># quick-plot tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfAddButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFilesDialog</span><span class="p">(</span><span class="s1">&#39;pmf&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfBox</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfClearButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPmfBox</span><span class="o">.</span><span class="n">clear</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfPlotButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plotPMFs</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfAddButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFilesDialog</span><span class="p">(</span><span class="s1">&#39;pmf&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfBox</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfClearButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mergePmfBox</span><span class="o">.</span><span class="n">clear</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mergePmfmergeButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mergePMFs</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceBrowseButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commonSlots</span><span class="o">.</span><span class="n">openFileDialog</span><span class="p">(</span><span class="s1">&#39;pmf&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergenceBox</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPmfConvergencePlotButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plotRMSDConvergence</span><span class="p">())</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Haohao Fu, Haochuan Chen.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>