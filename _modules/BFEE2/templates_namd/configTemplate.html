

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>BFEE2.templates_namd.configTemplate &mdash; BFEE2  documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> BFEE2
          

          
          </a>

          
            
            
              <div class="version">
                2.1.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../python_api.html">Python API</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">BFEE2</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>BFEE2.templates_namd.configTemplate</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for BFEE2.templates_namd.configTemplate</h1><div class="highlight"><pre>
<span></span><span class="c1"># generate NAMD/Gromacs/Colvars config files</span>

<div class="viewcode-block" id="configTemplate"><a class="viewcode-back" href="../../../BFEE2.templates_namd.html#BFEE2.templates_namd.configTemplate.configTemplate">[docs]</a><span class="k">class</span> <span class="nc">configTemplate</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39; generate NAMD/Gromacs/Colvars config files</span>
<span class="sd">        In the Colvars config file, ndx and xyz files are used to indicate the group of atoms</span>
<span class="sd">        The non-hydrogen atoms of protein are labeled as &#39;protein&#39; in complex.ndx</span>
<span class="sd">        The non-hydrogen atoms of ligand are labeled as &#39;ligand&#39; in complex.ndx</span>
<span class="sd">        The non-hydrogen atoms of user-defined reference are labeled as &#39;reference&#39; in complex.ndx &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="configTemplate.namdConfigTemplate"><a class="viewcode-back" href="../../../BFEE2.templates_namd.html#BFEE2.templates_namd.configTemplate.configTemplate.namdConfigTemplate">[docs]</a>    <span class="k">def</span> <span class="nf">namdConfigTemplate</span><span class="p">(</span>
                            <span class="bp">self</span><span class="p">,</span>
                            <span class="n">forceFieldType</span><span class="p">,</span>
                            <span class="n">forceFieldFiles</span><span class="p">,</span>
                            <span class="n">topFile</span><span class="p">,</span>
                            <span class="n">coorFile</span><span class="p">,</span>
                            <span class="n">NAMDRestartCoor</span><span class="p">,</span>
                            <span class="n">NAMDRestartVel</span><span class="p">,</span>
                            <span class="n">NAMDRestartXsc</span><span class="p">,</span>
                            <span class="n">PBCCondition</span><span class="p">,</span>
                            <span class="n">outputPrefix</span><span class="p">,</span>
                            <span class="n">temperature</span><span class="p">,</span>
                            <span class="n">numSteps</span><span class="p">,</span>
                            <span class="n">cvFile</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                            <span class="n">cvDefinitionFile</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                            <span class="n">CVRestartFile</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                            <span class="n">fepFile</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                            <span class="n">fepWindowNum</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                            <span class="n">fepForward</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                            <span class="n">fepDoubleWide</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="n">fepMinBeforeSample</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="n">membraneProtein</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;the namd config file template</span>

<span class="sd">        Args:</span>
<span class="sd">            forceFieldType (str): &#39;charmm&#39; or &#39;amber&#39;</span>
<span class="sd">            forceFieldFiles (list of str): name of charmm force field files</span>
<span class="sd">            topFile (str): name of the topology file (psf, parm) </span>
<span class="sd">            coorFile (str): name of the coordinate file (pdb, rst)</span>
<span class="sd">            NAMDRestartCoor (str): name of namd binary restart coor file (if restart from a previous simulation)</span>
<span class="sd">            NAMDRestartVel (str): name of namd binary restart vel file</span>
<span class="sd">            NAMDRestartXsc (str): name of namd restart xsc file</span>
<span class="sd">            PBCCondition (np.array, 2*3): PBC vector, ((lengthX, lengthY, lengthZ),(centerX, centerY, centerZ))</span>
<span class="sd">            outputPrefix (str): prefix of output file</span>
<span class="sd">            temperature (float): temperature of the simulation</span>
<span class="sd">            numSteps (int): number of steps of the simulation</span>
<span class="sd">            cvFile (str): name of Colvars file. Defaults to &#39;&#39;.</span>
<span class="sd">            cvDefinitionFile (str, optional): name of a TCL file defining new CVs. Defaults to &#39;&#39;.</span>
<span class="sd">            CVRestartFile (str, optional): name of Colvars restart file. Defaults to &#39;&#39;.</span>
<span class="sd">            fepFile (str, optional): name of fep file, indicating which atoms will be generated/removed </span>
<span class="sd">                                     (if run alchemical simulation). Defaults to &#39;&#39;.</span>
<span class="sd">            fepWindowNum (int, optional): number of fep windows. Defaults to 20.</span>
<span class="sd">            fepForward (bool, optional): whether this is a forward fep simulation. Defaults to True.</span>
<span class="sd">            fepDoubleWide (bool, optional): whether this is a double-wide fep simulation. Defaults to False.</span>
<span class="sd">            fepMinBeforeSample (bool, optional): whether do minimization before sampling in each FEP window.</span>
<span class="sd">                                                 Defaults to False.</span>
<span class="sd">            membraneProtein (bool, optional): whether simulating a membrame protein. Defaults to False.</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: a NAMD config string if succeed, and empty string otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span><span class="p">(</span><span class="n">forceFieldType</span> <span class="o">==</span> <span class="s1">&#39;charmm&#39;</span> <span class="ow">or</span> <span class="n">forceFieldType</span> <span class="o">==</span> <span class="s1">&#39;amber&#39;</span><span class="p">)</span>

        <span class="n">configString</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">coordinates    </span><span class="si">{</span><span class="n">coorFile</span><span class="si">}</span><span class="s1">                   </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1"># force field files</span>
        <span class="k">if</span> <span class="n">forceFieldType</span> <span class="o">==</span> <span class="s1">&#39;charmm&#39;</span><span class="p">:</span>
            <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">structure      </span><span class="si">{</span><span class="n">topFile</span><span class="si">}</span><span class="s1">                </span><span class="se">\n\</span>
<span class="s1">paraTypeCharmm    on                    </span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="n">forceFieldFiles</span><span class="p">:</span>
                <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">parameters    </span><span class="si">{</span><span class="n">ff</span><span class="si">}</span><span class="s1">                      </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">forceFieldType</span> <span class="o">==</span> <span class="s1">&#39;amber&#39;</span><span class="p">:</span>
            <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">parmFile      </span><span class="si">{</span><span class="n">topFile</span><span class="si">}</span><span class="s1">                 </span><span class="se">\n\</span>
<span class="s1">amber    on                             </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># error</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># structure</span>
        <span class="k">if</span> <span class="n">forceFieldType</span> <span class="o">==</span> <span class="s1">&#39;charmm&#39;</span><span class="p">:</span>
            <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">exclude    scaled1-4                    </span><span class="se">\n\</span>
<span class="s1">1-4scaling    1.0                       </span><span class="se">\n\</span>
<span class="s1">switching            on                 </span><span class="se">\n\</span>
<span class="s1">switchdist           10.0               </span><span class="se">\n\</span>
<span class="s1">cutoff               12.0               </span><span class="se">\n\</span>
<span class="s1">pairlistdist         14.0               </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">forceFieldType</span> <span class="o">==</span> <span class="s1">&#39;amber&#39;</span><span class="p">:</span>
            <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">exclude    scaled1-4                    </span><span class="se">\n\</span>
<span class="s1">1-4scaling    0.83333333                </span><span class="se">\n\</span>
<span class="s1">switching            on                 </span><span class="se">\n\</span>
<span class="s1">switchdist           8.0                </span><span class="se">\n\</span>
<span class="s1">cutoff               9.0                </span><span class="se">\n\</span>
<span class="s1">pairlistdist         11.0               </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># error</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="n">NAMDRestartCoor</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">NAMDRestartVel</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">NAMDRestartXsc</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">PBCCondition</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="c1"># set temperature</span>
            <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">temperature    </span><span class="si">{</span><span class="n">temperature</span><span class="si">}</span><span class="s1">                      </span><span class="se">\n\</span>
<span class="s1">cellBasisVector1    </span><span class="si">{</span><span class="n">PBCCondition</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> 0 0         </span><span class="se">\n\</span>
<span class="s1">cellBasisVector2    0 </span><span class="si">{</span><span class="n">PBCCondition</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1"> 0         </span><span class="se">\n\</span>
<span class="s1">cellBasisVector3    0 0 </span><span class="si">{</span><span class="n">PBCCondition</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">         </span><span class="se">\n\</span>
<span class="s1">cellOrigin    </span><span class="si">{</span><span class="n">PBCCondition</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">PBCCondition</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">PBCCondition</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">  </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">NAMDRestartCoor</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">NAMDRestartVel</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">NAMDRestartXsc</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">PBCCondition</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="c1"># restart from files</span>
            <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">bincoordinates    </span><span class="si">{</span><span class="n">NAMDRestartCoor</span><span class="si">}</span><span class="s1">                          </span><span class="se">\n\</span>
<span class="s1">binvelocities    </span><span class="si">{</span><span class="n">NAMDRestartVel</span><span class="si">}</span><span class="s1">                            </span><span class="se">\n\</span>
<span class="s1">ExtendedSystem    </span><span class="si">{</span><span class="n">NAMDRestartXsc</span><span class="si">}</span><span class="s1">                           </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># error</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># other parameters</span>
        <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">binaryoutput         yes                        </span><span class="se">\n\</span>
<span class="s1">binaryrestart        yes                        </span><span class="se">\n\</span>
<span class="s1">outputname           </span><span class="si">{</span><span class="n">outputPrefix</span><span class="si">}</span><span class="s1">             </span><span class="se">\n\</span>
<span class="s1">dcdUnitCell          yes                        </span><span class="se">\n\</span>
<span class="s1">outputenergies       5000                       </span><span class="se">\n\</span>
<span class="s1">outputtiming         5000                       </span><span class="se">\n\</span>
<span class="s1">outputpressure       5000                       </span><span class="se">\n\</span>
<span class="s1">restartfreq          5000                       </span><span class="se">\n\</span>
<span class="s1">XSTFreq              5000                       </span><span class="se">\n\</span>
<span class="s1">dcdFreq              5000                       </span><span class="se">\n\</span>
<span class="s1">hgroupcutoff         2.8                        </span><span class="se">\n\</span>
<span class="s1">wrapAll              off                        </span><span class="se">\n\</span>
<span class="s1">wrapWater            on                         </span><span class="se">\n\</span>
<span class="s1">langevin             on                         </span><span class="se">\n\</span>
<span class="s1">langevinDamping      1                          </span><span class="se">\n\</span>
<span class="s1">langevinTemp         300                        </span><span class="se">\n\</span>
<span class="s1">langevinHydrogen     no                         </span><span class="se">\n\</span>
<span class="s1">langevinpiston       on                         </span><span class="se">\n\</span>
<span class="s1">langevinpistontarget 1.01325                    </span><span class="se">\n\</span>
<span class="s1">langevinpistonperiod 200                        </span><span class="se">\n\</span>
<span class="s1">langevinpistondecay  100                        </span><span class="se">\n\</span>
<span class="s1">langevinpistontemp   </span><span class="si">{</span><span class="n">temperature</span><span class="si">}</span><span class="s1">              </span><span class="se">\n\</span>
<span class="s1">usegrouppressure     yes                        </span><span class="se">\n\</span>
<span class="s1">PME                  yes                        </span><span class="se">\n\</span>
<span class="s1">PMETolerance         10e-6                      </span><span class="se">\n\</span>
<span class="s1">PMEInterpOrder       4                          </span><span class="se">\n\</span>
<span class="s1">PMEGridSpacing       1.0                        </span><span class="se">\n\</span>
<span class="s1">timestep             2.0                        </span><span class="se">\n\</span>
<span class="s1">fullelectfrequency   2                          </span><span class="se">\n\</span>
<span class="s1">nonbondedfreq        1                          </span><span class="se">\n\</span>
<span class="s1">rigidbonds           all                        </span><span class="se">\n\</span>
<span class="s1">rigidtolerance       0.00001                    </span><span class="se">\n\</span>
<span class="s1">rigiditerations      400                        </span><span class="se">\n\</span>
<span class="s1">stepspercycle        10                         </span><span class="se">\n\</span>
<span class="s1">splitpatch           hydrogen                   </span><span class="se">\n\</span>
<span class="s1">margin               2                          </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1"># membrane protein</span>
        <span class="k">if</span> <span class="n">membraneProtein</span><span class="p">:</span>
            <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">useflexiblecell      yes                        </span><span class="se">\n\</span>
<span class="s1">useConstantRatio     yes                        </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">useflexiblecell      no                         </span><span class="se">\n\</span>
<span class="s1">useConstantRatio     no                         </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1"># colvars definition</span>
        <span class="k">if</span> <span class="n">cvFile</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">colvars    on                                   </span><span class="se">\n\</span>
<span class="s1">colvarsConfig    </span><span class="si">{</span><span class="n">cvFile</span><span class="si">}</span><span class="s1">                       </span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="k">if</span> <span class="n">CVRestartFile</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">colvarsInput     </span><span class="si">{</span><span class="n">CVRestartFile</span><span class="si">}</span><span class="s1">                </span><span class="se">\n</span><span class="s1">&#39;</span>


        <span class="k">if</span> <span class="n">cvDefinitionFile</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">source     </span><span class="si">{</span><span class="n">cvDefinitionFile</span><span class="si">}</span><span class="s1">                   </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1"># fep</span>
        <span class="k">if</span> <span class="n">fepFile</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NAMDRestartCoor</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">NAMDRestartVel</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">NAMDRestartXsc</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">minimize    500                                 </span><span class="se">\n\</span>
<span class="s1">reinitvels    </span><span class="si">{</span><span class="n">temperature</span><span class="si">}</span><span class="s1">                     </span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">run    </span><span class="si">{</span><span class="n">numSteps</span><span class="si">}</span><span class="s1">                               </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># currently the alchemical route is somewhat hard-coded</span>
            <span class="c1"># this will be improved in the future</span>
            <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">source ../fep.tcl                                  </span><span class="se">\n\</span>
<span class="s1">alch on                                         </span><span class="se">\n\</span>
<span class="s1">alchType FEP                                    </span><span class="se">\n\</span>
<span class="s1">alchFile </span><span class="si">{</span><span class="n">fepFile</span><span class="si">}</span><span class="s1">                              </span><span class="se">\n\</span>
<span class="s1">alchCol B                                       </span><span class="se">\n\</span>
<span class="s1">alchOutFile </span><span class="si">{</span><span class="n">outputPrefix</span><span class="si">}</span><span class="s1">.fepout               </span><span class="se">\n\</span>
<span class="s1">alchOutFreq 50                                  </span><span class="se">\n\</span>
<span class="s1">alchVdwLambdaEnd 0.7                            </span><span class="se">\n\</span>
<span class="s1">alchElecLambdaStart 0.5                         </span><span class="se">\n\</span>
<span class="s1">alchEquilSteps 100000                           </span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="k">if</span> <span class="n">fepForward</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">fepDoubleWide</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">fepMinBeforeSample</span><span class="p">:</span>
                        <span class="c1"># minimize before sampling</span>
                        <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">runFEPmin 0.0 1.0 </span><span class="si">{</span><span class="mf">1.0</span><span class="o">/</span><span class="n">fepWindowNum</span><span class="si">}</span><span class="s1"> 500000 1000 </span><span class="si">{</span><span class="n">temperature</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">runFEP 0.0 1.0 </span><span class="si">{</span><span class="mf">1.0</span><span class="o">/</span><span class="n">fepWindowNum</span><span class="si">}</span><span class="s1"> 500000</span><span class="se">\n</span><span class="s1">&#39;</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># double wide simulation</span>
                    <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">runFEP 0.0 1.0 </span><span class="si">{</span><span class="mf">1.0</span><span class="o">/</span><span class="n">fepWindowNum</span><span class="si">}</span><span class="s1"> 500000 true</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># backward</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">fepDoubleWide</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">fepMinBeforeSample</span><span class="p">:</span>
                        <span class="c1"># minimize before sampling</span>
                        <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">runFEPmin 1.0 0.0 </span><span class="si">{</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">fepWindowNum</span><span class="si">}</span><span class="s1"> 500000 1000 </span><span class="si">{</span><span class="n">temperature</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">runFEP 1.0 0.0 </span><span class="si">{</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">fepWindowNum</span><span class="si">}</span><span class="s1"> 500000</span><span class="se">\n</span><span class="s1">&#39;</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># double wide simulation</span>
                    <span class="n">configString</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">runFEP 1.0 0.0 </span><span class="si">{</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">fepWindowNum</span><span class="si">}</span><span class="s1"> 500000 true</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">return</span> <span class="n">configString</span></div>


<div class="viewcode-block" id="configTemplate.cvRMSDTemplate"><a class="viewcode-back" href="../../../BFEE2.templates_namd.html#BFEE2.templates_namd.configTemplate.configTemplate.cvRMSDTemplate">[docs]</a>    <span class="k">def</span> <span class="nf">cvRMSDTemplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setBoundary</span><span class="p">,</span> <span class="n">lowerBoundary</span><span class="p">,</span> <span class="n">upperBoundary</span><span class="p">,</span> <span class="n">refFile</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;RMSD CV template</span>

<span class="sd">        Args:</span>
<span class="sd">            setBoundary (bool): whether set boundary (for free-energy calculation)</span>
<span class="sd">            lowerBoundary (float): lower boundary of free-energy calculaton</span>
<span class="sd">            upperboundary (float): upper boundary of free-energy calculation</span>
<span class="sd">            refFile (str): path to the reference file</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: string of RMSD definition</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">colvar </span><span class="se">{{</span><span class="s1">                                    </span><span class="se">\n\</span>
<span class="s1">    name RMSD                                </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="n">setBoundary</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    width 0.05                               </span><span class="se">\n\</span>
<span class="s1">    lowerboundary </span><span class="si">{</span><span class="n">lowerBoundary</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">            </span><span class="se">\n\</span>
<span class="s1">    upperboundary </span><span class="si">{</span><span class="n">upperBoundary</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">            </span><span class="se">\n\</span>
<span class="s1">    subtractAppliedForce on                  </span><span class="se">\n\</span>
<span class="s1">    expandboundaries  on                     </span><span class="se">\n\</span>
<span class="s1">    extendedLagrangian on                    </span><span class="se">\n\</span>
<span class="s1">    extendedFluctuation 0.05                 </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    rmsd </span><span class="se">{{</span><span class="s1">                                  </span><span class="se">\n\</span>
<span class="s1">        atoms </span><span class="se">{{</span><span class="s1">                             </span><span class="se">\n\</span>
<span class="s1">            indexGroup  ligand               </span><span class="se">\n\</span>
<span class="s1">        </span><span class="se">}}</span><span class="s1">                                   </span><span class="se">\n\</span>
<span class="s1">        refpositionsfile  </span><span class="si">{</span><span class="n">refFile</span><span class="si">}</span><span class="s1">          </span><span class="se">\n\</span>
<span class="s1">    </span><span class="se">}}</span><span class="s1">                                       </span><span class="se">\n\</span>
<span class="se">}}</span><span class="s1">                                           </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">string</span></div>

<div class="viewcode-block" id="configTemplate.cvEulerAngleTemplate"><a class="viewcode-back" href="../../../BFEE2.templates_namd.html#BFEE2.templates_namd.configTemplate.configTemplate.cvEulerAngleTemplate">[docs]</a>    <span class="k">def</span> <span class="nf">cvEulerAngleTemplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setBoundary</span><span class="p">,</span> <span class="n">lowerBoundary</span><span class="p">,</span> <span class="n">upperBoundary</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">refFile</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Euler angle template</span>

<span class="sd">        Args:</span>
<span class="sd">            setBoundary (bool): whether set boundary (for free-energy calculation)</span>
<span class="sd">            lowerBoundary (float): lower boundary of free-energy calculaton</span>
<span class="sd">            upperboundary (float): upper boundary of free-energy calculation</span>
<span class="sd">            angle (str): &#39;eulerTheta&#39;, &#39;eulerPhi&#39; of &#39;eulerPsi&#39;</span>
<span class="sd">            refFile (str): path to the reference file</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            string: string of Euler angle definition</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span><span class="p">(</span><span class="n">angle</span> <span class="o">==</span> <span class="s1">&#39;eulerTheta&#39;</span> <span class="ow">or</span> <span class="n">angle</span> <span class="o">==</span> <span class="s1">&#39;eulerPhi&#39;</span> <span class="ow">or</span> <span class="n">angle</span> <span class="o">==</span> <span class="s1">&#39;eulerPsi&#39;</span><span class="p">)</span>
        
        <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">colvar </span><span class="se">{{</span><span class="s1">                              </span><span class="se">\n\</span>
<span class="s1">    name </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s1">                   </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="n">angle</span> <span class="o">==</span> <span class="s1">&#39;eulerTheta&#39;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    customFunction asin(2 * (q1*q3-q4*q2)) * 180 / 3.1415926</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">angle</span> <span class="o">==</span> <span class="s1">&#39;eulerPhi&#39;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    customFunction atan2(2*(q1*q2+q3*q4), 1-2*(q2*q2+q3*q3)) * 180 / 3.1415926</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">angle</span> <span class="o">==</span> <span class="s1">&#39;eulerPsi&#39;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    customFunction atan2(2*(q1*q4+q2*q3), 1-2*(q3*q3+q4*q4)) * 180 / 3.1415926</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="n">setBoundary</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    width 1                            </span><span class="se">\n\</span>
<span class="s1">    lowerboundary </span><span class="si">{</span><span class="n">lowerBoundary</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">      </span><span class="se">\n\</span>
<span class="s1">    upperboundary </span><span class="si">{</span><span class="n">upperBoundary</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">      </span><span class="se">\n\</span>
<span class="s1">    subtractAppliedForce on            </span><span class="se">\n\</span>
<span class="s1">    expandboundaries  on               </span><span class="se">\n\</span>
<span class="s1">    extendedLagrangian on              </span><span class="se">\n\</span>
<span class="s1">    extendedFluctuation 1              </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    Orientation </span><span class="se">{{</span><span class="s1">                             </span><span class="se">\n\</span>
<span class="s1">        name  q                                </span><span class="se">\n\</span>
<span class="s1">        atoms </span><span class="se">{{</span><span class="s1">                               </span><span class="se">\n\</span>
<span class="s1">            indexGroup  ligand                 </span><span class="se">\n\</span>
<span class="s1">            centerReference    on              </span><span class="se">\n\</span>
<span class="s1">            rotateReference    on              </span><span class="se">\n\</span>
<span class="s1">	        enableFitGradients no              </span><span class="se">\n\</span>
<span class="s1">            fittingGroup </span><span class="se">{{</span><span class="s1">                    </span><span class="se">\n\</span>
<span class="s1">                indexGroup  protein            </span><span class="se">\n\</span>
<span class="s1">            </span><span class="se">}}</span><span class="s1">                                 </span><span class="se">\n\</span>
<span class="s1">            refpositionsfile  </span><span class="si">{</span><span class="n">refFile</span><span class="si">}</span><span class="s1">        </span><span class="se">\n\</span>
<span class="s1">         </span><span class="se">}}</span><span class="s1">                                    </span><span class="se">\n\</span>
<span class="s1">         refpositionsfile  </span><span class="si">{</span><span class="n">refFile</span><span class="si">}</span><span class="s1">           </span><span class="se">\n\</span>
<span class="s1">    </span><span class="se">}}</span><span class="s1">                                         </span><span class="se">\n\</span>
<span class="se">}}</span><span class="s1">                                             </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">return</span> <span class="n">string</span></div>

<div class="viewcode-block" id="configTemplate.cvPolarAngleTemplate"><a class="viewcode-back" href="../../../BFEE2.templates_namd.html#BFEE2.templates_namd.configTemplate.configTemplate.cvPolarAngleTemplate">[docs]</a>    <span class="k">def</span> <span class="nf">cvPolarAngleTemplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setBoundary</span><span class="p">,</span> <span class="n">lowerBoundary</span><span class="p">,</span> <span class="n">upperBoundary</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">refFile</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Polar angle template</span>

<span class="sd">        Args:</span>
<span class="sd">            setBoundary (bool): whether set boundary (for free-energy calculation)</span>
<span class="sd">            lowerBoundary (float): lower boundary of free-energy calculaton</span>
<span class="sd">            upperboundary (float): upper boundary of free-energy calculation</span>
<span class="sd">            angle (str): &#39;polarTheta&#39; or &#39;polarPhi&#39;</span>
<span class="sd">            refFile (str): path to the reference file</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            str: string of polar angle definition</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span><span class="p">(</span><span class="n">angle</span> <span class="o">==</span> <span class="s1">&#39;polarTheta&#39;</span> <span class="ow">or</span> <span class="n">angle</span> <span class="o">==</span> <span class="s1">&#39;polarPhi&#39;</span><span class="p">)</span>
        
        <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">colvar </span><span class="se">{{</span><span class="s1">                                   </span><span class="se">\n\</span>
<span class="s1">    name </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s1">                            </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="n">angle</span> <span class="o">==</span> <span class="s1">&#39;polarTheta&#39;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    customFunction acos(-i2) * 180 / 3.1415926</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">angle</span> <span class="o">==</span> <span class="s1">&#39;polarPhi&#39;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    customFunction atan2(i3, i1) * 180 / 3.1415926</span><span class="se">\n\</span>
<span class="s1">    period  360                             </span><span class="se">\n\</span>
<span class="s1">    wrapAround 0.0                          </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="n">setBoundary</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    width 1                                 </span><span class="se">\n\</span>
<span class="s1">    lowerboundary </span><span class="si">{</span><span class="n">lowerBoundary</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">           </span><span class="se">\n\</span>
<span class="s1">    upperboundary </span><span class="si">{</span><span class="n">upperBoundary</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">           </span><span class="se">\n\</span>
<span class="s1">    subtractAppliedForce on                 </span><span class="se">\n\</span>
<span class="s1">    expandboundaries  on                    </span><span class="se">\n\</span>
<span class="s1">    extendedLagrangian on                   </span><span class="se">\n\</span>
<span class="s1">    extendedFluctuation 1                   </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    distanceDir </span><span class="se">{{</span><span class="s1">                          </span><span class="se">\n\</span>
<span class="s1">        name  i                             </span><span class="se">\n\</span>
<span class="s1">        group1 </span><span class="se">{{</span><span class="s1">                           </span><span class="se">\n\</span>
<span class="s1">            indexGroup  reference           </span><span class="se">\n\</span>
<span class="s1">            centerReference    on           </span><span class="se">\n\</span>
<span class="s1">            rotateReference    on           </span><span class="se">\n\</span>
<span class="s1">            enableFitGradients no           </span><span class="se">\n\</span>
<span class="s1">            fittingGroup </span><span class="se">{{</span><span class="s1">                 </span><span class="se">\n\</span>
<span class="s1">                indexGroup  protein         </span><span class="se">\n\</span>
<span class="s1">            </span><span class="se">}}</span><span class="s1">                              </span><span class="se">\n\</span>
<span class="s1">            refpositionsfile  </span><span class="si">{</span><span class="n">refFile</span><span class="si">}</span><span class="s1">     </span><span class="se">\n\</span>
<span class="s1">        </span><span class="se">}}</span><span class="s1">                                  </span><span class="se">\n\</span>
<span class="s1">        group2 </span><span class="se">{{</span><span class="s1">                           </span><span class="se">\n\</span>
<span class="s1">            indexGroup  ligand              </span><span class="se">\n\</span>
<span class="s1">            centerReference    on           </span><span class="se">\n\</span>
<span class="s1">            rotateReference    on           </span><span class="se">\n\</span>
<span class="s1">            enableFitGradients no           </span><span class="se">\n\</span>
<span class="s1">            fittingGroup </span><span class="se">{{</span><span class="s1">                 </span><span class="se">\n\</span>
<span class="s1">                indexGroup  protein         </span><span class="se">\n\</span>
<span class="s1">            </span><span class="se">}}</span><span class="s1">                              </span><span class="se">\n\</span>
<span class="s1">            refpositionsfile  </span><span class="si">{</span><span class="n">refFile</span><span class="si">}</span><span class="s1">     </span><span class="se">\n\</span>
<span class="s1">        </span><span class="se">}}</span><span class="s1">                                  </span><span class="se">\n\</span>
<span class="s1">    </span><span class="se">}}</span><span class="s1">                                      </span><span class="se">\n\</span>
<span class="se">}}</span><span class="s1">                                          </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">string</span></div>

<div class="viewcode-block" id="configTemplate.cvRTemplate"><a class="viewcode-back" href="../../../BFEE2.templates_namd.html#BFEE2.templates_namd.configTemplate.configTemplate.cvRTemplate">[docs]</a>    <span class="k">def</span> <span class="nf">cvRTemplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setBoundary</span><span class="p">,</span> <span class="n">lowerBoundary</span><span class="p">,</span> <span class="n">upperBoundary</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;r distance template</span>

<span class="sd">        Args:</span>
<span class="sd">            setBoundary (bool): whether set boundary (for free-energy calculation)</span>
<span class="sd">            lowerBoundary (float): lower boundary of free-energy calculaton</span>
<span class="sd">            upperboundary (float): upper boundary of free-energy </span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: string of distance r definition</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">colvar </span><span class="se">{{</span><span class="s1">                            </span><span class="se">\n\</span>
<span class="s1">    name    r                        </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">setBoundary</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    width 0.1                        </span><span class="se">\n\</span>
<span class="s1">    lowerboundary </span><span class="si">{</span><span class="n">lowerBoundary</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">    </span><span class="se">\n\</span>
<span class="s1">    upperboundary </span><span class="si">{</span><span class="n">upperBoundary</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">    </span><span class="se">\n\</span>
<span class="s1">    subtractAppliedForce on          </span><span class="se">\n\</span>
<span class="s1">    expandboundaries  on             </span><span class="se">\n\</span>
<span class="s1">    extendedLagrangian on            </span><span class="se">\n\</span>
<span class="s1">    extendedFluctuation 0.1          </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    distance </span><span class="se">{{</span><span class="s1">                            </span><span class="se">\n\</span>
<span class="s1">        forceNoPBC       yes               </span><span class="se">\n\</span>
<span class="s1">        group1 </span><span class="se">{{</span><span class="s1">                          </span><span class="se">\n\</span>
<span class="s1">            indexGroup  reference          </span><span class="se">\n\</span>
<span class="s1">	    </span><span class="se">}}</span><span class="s1">                                 </span><span class="se">\n\</span>
<span class="s1">        group2 </span><span class="se">{{</span><span class="s1">                          </span><span class="se">\n\</span>
<span class="s1">            indexGroup  ligand             </span><span class="se">\n\</span>
<span class="s1">        </span><span class="se">}}</span><span class="s1">                                 </span><span class="se">\n\</span>
<span class="s1">    </span><span class="se">}}</span><span class="s1">                                     </span><span class="se">\n\</span>
<span class="se">}}</span><span class="s1">                                         </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">return</span> <span class="n">string</span></div>

<div class="viewcode-block" id="configTemplate.cvHeadTemplate"><a class="viewcode-back" href="../../../BFEE2.templates_namd.html#BFEE2.templates_namd.configTemplate.configTemplate.cvHeadTemplate">[docs]</a>    <span class="k">def</span> <span class="nf">cvHeadTemplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indexFile</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return the head of colvars file</span>

<span class="sd">        Args:</span>
<span class="sd">            indexFile (str): name of ndx file</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: head of colvars file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">colvarsTrajFrequency      500              </span><span class="se">\n\</span>
<span class="s1">colvarsRestartFrequency   50000            </span><span class="se">\n\</span>
<span class="s1">indexFile                 </span><span class="si">{</span><span class="n">indexFile</span><span class="si">}</span><span class="s1">      </span><span class="se">\n</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="configTemplate.cvHarmonicWallsTemplate"><a class="viewcode-back" href="../../../BFEE2.templates_namd.html#BFEE2.templates_namd.configTemplate.configTemplate.cvHarmonicWallsTemplate">[docs]</a>    <span class="k">def</span> <span class="nf">cvHarmonicWallsTemplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">lowerWall</span><span class="p">,</span> <span class="n">upperWall</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; template of harmonic wall bias</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            cv (str): name of the colvars</span>
<span class="sd">            lowerWall (float): lower wall of the bias</span>
<span class="sd">            upperWall (float): upper wall of the bias</span>
<span class="sd">                </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: string of the harmonic wall bias definition &#39;&#39;&#39;</span>
            
        <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">harmonicWalls </span><span class="se">{{</span><span class="s1">                           </span><span class="se">\n\</span>
<span class="s1">    colvars           </span><span class="si">{</span><span class="n">cv</span><span class="si">}</span><span class="s1">                 </span><span class="se">\n\</span>
<span class="s1">    lowerWalls        </span><span class="si">{</span><span class="n">lowerWall</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">      </span><span class="se">\n\</span>
<span class="s1">    upperWalls        </span><span class="si">{</span><span class="n">upperWall</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">      </span><span class="se">\n\</span>
<span class="s1">    lowerWallConstant 0.2                  </span><span class="se">\n\</span>
<span class="s1">    upperWallConstant 0.2                  </span><span class="se">\n\</span>
<span class="se">}}</span><span class="s1">                                         </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">string</span></div>

<div class="viewcode-block" id="configTemplate.cvHarmonicTemplate"><a class="viewcode-back" href="../../../BFEE2.templates_namd.html#BFEE2.templates_namd.configTemplate.configTemplate.cvHarmonicTemplate">[docs]</a>    <span class="k">def</span> <span class="nf">cvHarmonicTemplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">constant</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">tiWindows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tiForward</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">targetForceConstant</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;template for a harmonic restraint</span>

<span class="sd">        Args:</span>
<span class="sd">            cv (str): name of the colvars</span>
<span class="sd">            constant (float): force constant of the restraint</span>
<span class="sd">            center (float): center of the restraint</span>
<span class="sd">            tiWindows (int): number of windows of the TI simulation (if runs a TI simulation). Defaults to 0.</span>
<span class="sd">            tiForward (bool, optional): whether the TI simulation is forward (if runs a TI simulation). Defaults to True.</span>
<span class="sd">            targetForceConstant (int, optional): targeted force constant of the restraint in TI simulation (if runs a TI simulation).</span>
<span class="sd">                                                 Defaults to 0.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: string of the harmonic restraint definition</span>
<span class="sd">        &quot;&quot;&quot;</span>        

        <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">harmonic </span><span class="se">{{</span><span class="s1">                          </span><span class="se">\n\</span>
<span class="s1">    colvars         </span><span class="si">{</span><span class="n">cv</span><span class="si">}</span><span class="s1">             </span><span class="se">\n\</span>
<span class="s1">    forceConstant   </span><span class="si">{</span><span class="n">constant</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">   </span><span class="se">\n\</span>
<span class="s1">    centers         </span><span class="si">{</span><span class="n">center</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">     </span><span class="se">\n</span><span class="s1">&#39;</span>
        
        <span class="k">if</span> <span class="n">tiWindows</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">    targetNumSteps      500000                       </span><span class="se">\n\</span>
<span class="s1">    targetEquilSteps    100000                       </span><span class="se">\n\</span>
<span class="s1">    targetForceConstant </span><span class="si">{</span><span class="n">targetForceConstant</span><span class="si">}</span><span class="s1">        </span><span class="se">\n\</span>
<span class="s1">    targetForceExponent 4                            </span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">schedule</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="n">tiForward</span><span class="p">:</span>
                <span class="n">schedule</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">tiWindows</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tiWindows</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">schedule</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">tiWindows</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tiWindows</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
            
            <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;    lambdaSchedule </span><span class="si">{</span><span class="n">schedule</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">string</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">string</span></div>

<div class="viewcode-block" id="configTemplate.cvABFTemplate"><a class="viewcode-back" href="../../../BFEE2.templates_namd.html#BFEE2.templates_namd.configTemplate.configTemplate.cvABFTemplate">[docs]</a>    <span class="k">def</span> <span class="nf">cvABFTemplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cv</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; template for WTM-eABF bias</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            cv (str): name of the colvars</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: string of the WTM-eABF definition &#39;&#39;&#39;</span>
            
        <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">abf </span><span class="se">{{</span><span class="s1">                            </span><span class="se">\n\</span>
<span class="s1">    colvars        </span><span class="si">{</span><span class="n">cv</span><span class="si">}</span><span class="s1">           </span><span class="se">\n\</span>
<span class="s1">    FullSamples    10000          </span><span class="se">\n\</span>
<span class="s1">    historyfreq    50000          </span><span class="se">\n\</span>
<span class="s1">    writeCZARwindowFile           </span><span class="se">\n\</span>
<span class="se">}}</span><span class="s1">                                </span><span class="se">\n\</span>
<span class="s1">metadynamics </span><span class="se">{{</span><span class="s1">                   </span><span class="se">\n\</span>
<span class="s1">    colvars           </span><span class="si">{</span><span class="n">cv</span><span class="si">}</span><span class="s1">        </span><span class="se">\n\</span>
<span class="s1">    hillWidth         3.0         </span><span class="se">\n\</span>
<span class="s1">    hillWeight        0.05        </span><span class="se">\n\</span>
<span class="s1">    wellTempered      on          </span><span class="se">\n\</span>
<span class="s1">    biasTemperature   4000        </span><span class="se">\n\</span>
<span class="se">}}</span><span class="s1">                                </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">string</span></div>

<div class="viewcode-block" id="configTemplate.cvProteinTemplate"><a class="viewcode-back" href="../../../BFEE2.templates_namd.html#BFEE2.templates_namd.configTemplate.configTemplate.cvProteinTemplate">[docs]</a>    <span class="k">def</span> <span class="nf">cvProteinTemplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">centerCoor</span><span class="p">,</span> <span class="n">refFile</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;the template of restraining the protein</span>

<span class="sd">        Args:</span>
<span class="sd">            centerCoor (np.array, 3): (x,y,z), center of the protein </span>
<span class="sd">            refFile (str): path of the reference file</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: string of the restraining the protein</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">colvar </span><span class="se">{{</span><span class="s1">                         </span><span class="se">\n\</span>
<span class="s1">  name translation                </span><span class="se">\n\</span>
<span class="s1">  distance </span><span class="se">{{</span><span class="s1">                     </span><span class="se">\n\</span>
<span class="s1">    group1 </span><span class="se">{{</span><span class="s1">                     </span><span class="se">\n\</span>
<span class="s1">      indexGroup  protein         </span><span class="se">\n\</span>
<span class="s1">    </span><span class="se">}}</span><span class="s1">                            </span><span class="se">\n\</span>
<span class="s1">    group2 </span><span class="se">{{</span><span class="s1">                     </span><span class="se">\n\</span>
<span class="s1">      dummyAtom (</span><span class="si">{</span><span class="n">centerCoor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">centerCoor</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">centerCoor</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">)    </span><span class="se">\n\</span>
<span class="s1">    </span><span class="se">}}</span><span class="s1">                            </span><span class="se">\n\</span>
<span class="s1">  </span><span class="se">}}</span><span class="s1">                              </span><span class="se">\n\</span>
<span class="se">}}</span><span class="s1">                                </span><span class="se">\n\</span>
<span class="s1">harmonic </span><span class="se">{{</span><span class="s1">                       </span><span class="se">\n\</span>
<span class="s1">  colvars       translation       </span><span class="se">\n\</span>
<span class="s1">  centers       0.0               </span><span class="se">\n\</span>
<span class="s1">  forceConstant 100.0             </span><span class="se">\n\</span>
<span class="se">}}</span><span class="s1">                                </span><span class="se">\n\</span>
<span class="s1">                                  </span><span class="se">\n\</span>
<span class="s1">colvar </span><span class="se">{{</span><span class="s1">                         </span><span class="se">\n\</span>
<span class="s1">  name orientation                </span><span class="se">\n\</span>
<span class="s1">  orientation </span><span class="se">{{</span><span class="s1">                  </span><span class="se">\n\</span>
<span class="s1">    atoms </span><span class="se">{{</span><span class="s1">                      </span><span class="se">\n\</span>
<span class="s1">      indexGroup  protein         </span><span class="se">\n\</span>
<span class="s1">    </span><span class="se">}}</span><span class="s1">                            </span><span class="se">\n\</span>
<span class="s1">    refPositionsFile   </span><span class="si">{</span><span class="n">refFile</span><span class="si">}</span><span class="s1">  </span><span class="se">\n\</span>
<span class="s1">  </span><span class="se">}}</span><span class="s1">                              </span><span class="se">\n\</span>
<span class="se">}}</span><span class="s1">                                </span><span class="se">\n\</span>
<span class="s1">harmonic </span><span class="se">{{</span><span class="s1">                       </span><span class="se">\n\</span>
<span class="s1">  colvars       orientation       </span><span class="se">\n\</span>
<span class="s1">  centers       (1.0, 0.0, 0.0, 0.0)    </span><span class="se">\n\</span>
<span class="s1">  forceConstant 2000.0            </span><span class="se">\n\</span>
<span class="se">}}</span><span class="s1">                                </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">string</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Haohao Fu, Haochuan Chen.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>